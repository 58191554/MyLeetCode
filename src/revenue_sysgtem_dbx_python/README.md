Customer Revenue System
Medium
Heap
Interview Stages
Screening
Frequency
Asked By

Last Reported
1 months ago
A company operates a revenue-tracking system to monitor customer contributions. Each time a customer generates revenue, the system records the amount and the associated customer. Customers can also refer new customers, and when a referred customer generates revenue, that amount is credited to both the referrer and the referred customer.

A customer's total revenue is defined as the sum of their own revenue and the revenue generated by the customers they directly referred.

Implement the RevenueSystem class:

RevenueSystem() Initializes the revenue system.

int add(int revenue) Adds a new customer with the specified revenue and returns a unique, auto-incremented customer ID starting from 0.

int addByReferral(int revenue, int referrerId) Records a new customer who generates revenue, referred by referrerId, and the referrer's total revenue increases by revenue too. Returns the new customer's ID (auto-incremented, starting from 0). If referrerId is invalid, return -1.

List<Integer> getTopKCustomer(int k, int minRevenue) Returns up to k customer IDs whose total revenue is at least minRevenue and sorted in descending order of total revenue. The result is guaranteed to be unique.

Example

Input:
["RevenueSystem", "add", "add", "addByReferral", "addByReferral", "add", "getTopKCustomer", "addByReferral", "getTopKCustomer"]
[[], [100], [50], [30, 0], [70, 1], [50], [2, 100], [50, 4], [3, 100]]

Output:
[null, 0, 1, 2, 3, 4, [0, 1], 5, [0, 1, 4]]

Explanation:

RevenueSystem system = new RevenueSystem();
system.add(100); // Returns 0. Adds a new customer (customer "0") with revenue $100: [{0: $100}]
system.add(50); // Returns 1. Adds a new customer (customer "1") with revenue $50: [{0: $100}, {1: $50}]
system.addByReferral(30, 0); // Returns 2. Customer "0" refers to a new customer (customer "2") with revenue $30: [{0: $130}, {1: $50}, {2: $30}]
system.addByReferral(70, 1); // Returns 3. Customer "1" refers to a new customer (customer "3") with revenue $70: [{0: $130}, {1: $120}, {2: $30}, {3: $70}]
system.add(50); // Returns 4. [{0: $130}, {1: $120}, {2: $30}, {3: $70}, {4: $50}]
system.getTopKCustomer(2, 100); // Returns [0, 1].
system.addByReferral(50, 4); // Returns 5: [{0: $130}, {1: $120}, {2: $30}, {3: $70}, {4: $100}]
system.getTopKCustomer(3, 100); // Returns [0, 1, 4].
